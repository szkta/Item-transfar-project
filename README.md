# スプレッドシートが機能しなくなったときは
もしうまく動作しなかったときは、スプレッドシートと同じ名前のフォルダを開き、その中のファイルの内容をすべてコピーして、Apps Scriptの同じ名前のファイルに貼り付けてください。
もしくは大本のスプレッドシートをコピーし、それをデプロイして利用してください。

デプロイのやり方は以下の通りです。

1.パソコン室のパソコンを使って、デプロイしたいスプレッドシートを開く

2.拡張機能→Apps Scriptをクリックする

3.デプロイ→新しいデプロイをクリックする

4.次のユーザーとして実行を「自分」、アクセスできるユーザーを「全員」に設定したら「デプロイ」をクリック

5.このウェブ アプリケーションを使用するには、データへのアクセスを許可する必要があります、と出るので、「アクセスを承認」をクリック。

6.ポップアップして「Choose an account from kenryo.ed.jp」と出るので、自分の縣陵メールアドレスをクリック。

7.「～～wants to access your Google Account」と出ますが、これは「あなたのアカウントを利用してスプレッドシートに書き込む許可を与えるので正しいかどうか確認してください」という内容なので「Allow」をクリック。
そうすると、デプロイを更新しました、と出るはずです。ウェブアプリと書かれた下のURLが **「専用サイト」のURL** なのでどこかに保存しておいてください。
専用サイトのURLは「デプロイ」→「デプロイを管理」からも確認できます。

# スプレッドシートがうまく機能しなくなったときは
以下にシートごとの使用関数と説明を載せるので、指示に従って書き換えてください。

## Databaseシート
### C列
```
=IFERROR(VLOOKUP(MAXIFS(Data!$A:$A,Data!$B:$B,"登録",Data!$D:$D,A2),Data!$A:$D,3,false),"存在しません")
```
DataシートのA列に時刻が入っているので、登録した物品かつA2（生徒用椅子）の値の中から一番新しいものを探し、記録されたデータの３列目（保管場所）を表示させる。
もしこのコードが使われていないなら存在しませんを表示。

### D列
```
=IFERROR(VLOOKUP(MAXIFS(Data!$A:$A,Data!$B:$B,"搬入",Data!$D:$D,A2),Data!$A:$D,3,false),"移動していません")
```
DataシートのA列に時刻が入っているので、搬入した物品かつA2（生徒用椅子）の値の中から一番新しいものを探し、記録されたデータの３列目（搬入場所）を表示させる

### E列
```
=IFERROR(VLOOKUP(MAXIFS(Data!$A:$A,Data!$B:$B,"貸出",Data!$D:$D,A2),Data!$A:$D,3,false),"貸し出していません")
```
DataシートのA列に時刻が入っているので、貸出した物品かつA2（生徒用椅子）の値の中から一番新しいものを探し、記録されたデータの３列目（貸出団体）を表示させる

### F列
```
=IFERROR(VLOOKUP(E2,'責任者'!$A$1:$B$20,2,FALSE),"貸し出していません")
```
E列の値から責任者を検索して表示する。

### G列
```
=IFERROR(IFS(VLOOKUP(MAXIFS(Data!$A:$A,Data!$D:$D,A2),Data!$A:$D,2,false)="貸出","未返却",VLOOKUP(MAXIFS(Data!$A:$A,Data!$D:$D,A2),Data!$A:$D,2,false)="返却","返却済み"),"貸し出していません")
```
DataシートのA列に時刻が入っているので、貸出した物品かつA2（生徒用椅子）の値の中から一番新しいものを探し、それが「貸出」であったら「未返却」とし、「返却」だったら「返却済み」、それ以外なら「貸し出していません」と表示。


## Datatabeシート
### B列
```
=Data!A1
```
DataシートのA1を表示

### C列
```
=Data!B1
```
DataシートのB1を表示

### D列
```
=Data!C1
```
DataシートのC1を表示

### E列
```
=Data!D1
```
DataシートのD1を表示

### F列
```
=iferror(IFS(COUNTIF($E2,"C*")=1,"生徒用椅子",COUNTIF($E2,"D*")=1,"生徒用机",COUNTIF($E2,"E*")=1,"教卓",COUNTIF($E2,"F*")=1,"パイプ椅子",COUNTIF($E2,"G*")=1,"長机"),"")
```
E列の物品コードがCで始まるなら「生徒用椅子」、Dで始まるなら「生徒用机」...のようにしている。

### G列
```
=IFERROR(VLOOKUP($E2,Database!$A:$D,3,FALSE()),"")
```
E列の物品が元々どこにあったかを表示する。

第７７回縣陵祭 総務課物品移動係 鈴木
